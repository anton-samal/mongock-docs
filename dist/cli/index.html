<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Mongock Documentation">

    <title>Mongock Documentation</title>

    <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" sizes="any" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" />
    <link rel="shortcut icon" href="/favicon/favicon.ico" />
    <link href="/styles/base-styles.css" rel="stylesheet" />
    <link href="/styles/content.css" rel="stylesheet" />
    <link href="/styles/layout.css" rel="stylesheet" />
    <link href="/styles/side-menu.css" rel="stylesheet" />
    <link href="/styles/util.css" rel="stylesheet" />
    <link href="/styles/prism-base16-ateliersulphurpool.light.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Fjalla+One|Roboto" rel="stylesheet" />
  </head>

  <body>

    <!-- Header navigation -->
    <header>
  <div class="page-max-width d-flex flex-space-between flex-content-center">
    <div class="d-flex flex-items-center ml-0 mr-auto">
      <a class="logo d-inline-flex flex-items-center" href="https://www.mongock.io">
        <span class="mr-12">Mongock</span>
        <p class="text-left">
          <img src="/images/logo.png" width="15%" alt="Mongock">
        </p>  
       </a>
    </div>

    <nav class="d-flex flex-items-center ml-auto mr-0">
      <a class="mr-24" href="/">
        Home
      </a>
      <a href="https://github.com/mongock/mongock" target="_blank" rel="nofolllow">
        <!-- Source: <https://github.com/encharm/Font-Awesome-SVG-PNG/blob/master/black/svg/github.svg> -->
<svg focusable="false" viewBox="0 0 1792 1792"><title>GitHub</title><path d="M896 128q209 0 385.5 103t279.5 279.5 103 385.5q0 251-146.5 451.5t-378.5 277.5q-27 5-40-7t-13-30q0-3 .5-76.5t.5-134.5q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-119-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-85-13.5q-45 113-8 204-79 87-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-39 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 88.5t.5 54.5q0 18-13 30t-40 7q-232-77-378.5-277.5t-146.5-451.5q0-209 103-385.5t279.5-279.5 385.5-103zm-477 1103q3-7-7-12-10-3-13 2-3 7 7 12 9 6 13-2zm31 34q7-5-2-16-10-9-16-3-7 5 2 16 10 10 16 3zm30 45q9-7 0-19-8-13-17-6-9 5 0 18t17 7zm42 42q8-8-4-19-12-12-20-3-9 8 4 19 12 12 20 3zm57 25q3-11-13-16-15-4-19 7t13 15q15 6 19-6zm63 5q0-13-17-11-16 0-16 11 0 13 17 11 16 0 16-11zm58-10q-2-11-18-9-16 3-14 15t18 8 14-14z"></path></svg>

        <span class="ml-8">GitHub</span>
      </a>
    </nav>
  </div>
</header>


    <!-- Main page content -->
    <main class="page-max-width">
      



<aside class="side-menu">
  <h2>Navigation</h2>
  <nav class="menu-root">
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/index.html">
        What is mongock
      </a>
    
  </h7>

      <nav class="What is mongock">
        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/technical-overview/index.html">
        Technical overview
      </a>
    
  </h7>

      <nav class="Technical overview">
        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/get-started/index.html">
        Get started
      </a>
    
  </h7>

      <nav class="Get started">
        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/migration/index.html">
        Migration
      </a>
    
  </h7>

      <nav class="Migration">
        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/runner/index.html">
        Runner
      </a>
    
  </h7>

      <nav class="Runner">
        
          
  
  <a class="menu-item "  href="/runner/standalone/index.html">
    Runner: standalone
  </a>

        
          
  
  <a class="menu-item "  href="/runner/springboot/index.html">
    Runner: springboot
  </a>

        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/driver/index.html">
        Driver
      </a>
    
  </h7>

      <nav class="Driver">
        
          
  
  <a class="menu-item "  href="/driver/mongodb/index.html">
    Driver: mongodb
  </a>

        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      Features
    
  </h7>

      <nav class="Features">
        
          
  
  <a class="menu-item "  href="/features/transactions/index.html">
    Transactions
  </a>

        
          
  
  <a class="menu-item "  href="/features/events/index.html">
    Events
  </a>

        
          
  
  <a class="menu-item "  href="/features/legacy-migration/index.html">
    Legacy migration
  </a>

        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item current-page"  href="/cli/index.html">
        Cli
      </a>
    
  </h7>

      <nav class="Cli">
        
          
  
  <a class="menu-item "  href="/cli/operations/index.html">
    Operations
  </a>

        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/faq/index.html">
        Faq
      </a>
    
  </h7>

      <nav class="Faq">
        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/roadmap/index.html">
        Roadmap
      </a>
    
  </h7>

      <nav class="Roadmap">
        
      </nav>
    
      
  
  <h7 class="menu-item">
    
      <a class="menu-item "  href="/pending/index.html">
        Pending
      </a>
    
  </h7>

      <nav class="Pending">
        
      </nav>
    

  



            
    

  </nav>
</aside>

      <article>
        <p><div class="table-of-contents"><h2>Table of Contents</h2><ul><li><a href="#introduction">Introduction</a></li><li><a href="#steps">Steps</a><ul><li><a href="#1.-install-cli">1. Install CLI</a></li><li><a href="#2.-prepare-your-application">2. Prepare your application</a><ul><li><a href="#with-springboot">With Springboot</a></li><li><a href="#with-standalone">With standalone</a></li></ul></li></ul></li><li><a href="#considerations">Considerations</a></li></ul></div></p>
<h1 id="introduction"><a class="header-anchor" href="#introduction">#</a> Introduction</h1>
<p>So far we have explained how to run Mongock as part of your application, normally at the application's startup stage. This section explains how to run those migrations, and other operations, independely from the CLI.</p>
<h1 id="steps"><a class="header-anchor" href="#steps">#</a> Steps</h1>
<h2 id="1.-install-cli"><a class="header-anchor" href="#1.-install-cli">#</a> 1. Install CLI</h2>
<ol>
<li>Download the latest version of the <strong>mongock-cli-LATEST_VERSION.zip</strong> from <a href="https://repo.maven.apache.org/maven2/io/mongock/mongock-cli/"><img src="https://maven-badges.herokuapp.com/maven-central/io.mongock/mongock-cli/badge.png" alt="Maven Central"></a></li>
<li>Unzip it</li>
<li>Open a terminal and locate it inside the unzipped folder</li>
<li>Run the one of the operations available in <a href="/cli/operations">opreations page</a></li>
</ol>
<h2 id="2.-prepare-your-application"><a class="header-anchor" href="#2.-prepare-your-application">#</a> 2. Prepare your application</h2>
<h3 id="with-springboot"><a class="header-anchor" href="#with-springboot">#</a> With Springboot</h3>
<p>If using Springboot in the application, there is not much to be done. Springboot creates already an uber jar with all the dependencies in it.</p>
<p>By default the Mongock CLI loads the entire application context. If you want the CLI only to load specific configuration classes that are enough to run the migrations,you can do this annotatting your main class with <code>@MongockCliConfiguration</code>.</p>
<pre class="language-java"><code class="language-java"><div class="highlight-line"><span class="token comment">// The Mongock CLI will load the configuration from the classes io.your.package.ConfigurationClass1 and io.your.package.ConfigurationClass2.</span></div><div class="highlight-line"><span class="token comment">// Theses classes must contain all the beans and configuration needed to run the migration</span></div><div class="highlight-line"><span class="token annotation punctuation">@EnableMongock</span></div><div class="highlight-line"><span class="token annotation punctuation">@MongockCliConfiguration</span><span class="token punctuation">(</span>sources <span class="token operator">=</span> <span class="token punctuation">{</span></div><div class="highlight-line">        <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>your<span class="token punctuation">.</span>package<span class="token punctuation">.</span></span>ConfigurationClass1</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span></div><div class="highlight-line">        <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>your<span class="token punctuation">.</span>package<span class="token punctuation">.</span></span>ConfigurationClass2</span><span class="token punctuation">.</span><span class="token keyword">class</span></div><div class="highlight-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></div><div class="highlight-line"><span class="token annotation punctuation">@SpringBootApplication</span></div><div class="highlight-line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringBootSpringDataAnnotationBasicApp</span><span class="token punctuation">{</span></div><div class="highlight-line">  <span class="token comment">//...</span></div><div class="highlight-line"><span class="token punctuation">}</span></div></code></pre>
<div class="success">When using the builder approach(no <b>@EnableMongock</b>), the RunnerBuilder must be injected as a bean in the application context.</div>
<h3 id="with-standalone"><a class="header-anchor" href="#with-standalone">#</a> With standalone</h3>
<p>When the application uses the Mongock standalone runner, it need the following to be able to work with the CLI:</p>
<ul>
<li>Implement the interface <code>MongockBuilderProvider</code> returning the runner builder used in the application.</li>
<li>Annotate the main class with <code>@MongockCliConfiguration</code> providing the <code>MongockBuilderProvider</code> implementation class.</li>
<li>Generate an uber jar from the application, which will be passed to the Mongock CLI in the param <code>--appJar</code></li>
</ul>
<pre class="language-java"><code class="language-java"><div class="highlight-line"><span class="token annotation punctuation">@MongockCliConfiguration</span><span class="token punctuation">(</span>sources <span class="token operator">=</span> <span class="token class-name">Application<span class="token punctuation">.</span>MongockBuilderProviderImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span></div><div class="highlight-line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span></div><div class="highlight-line"></div><div class="highlight-line">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></div><div class="highlight-line">    <span class="token comment">//TODO your logic is not executed in the Mongock CLI</span></div><div class="highlight-line">  <span class="token punctuation">}</span></div><div class="highlight-line"></div><div class="highlight-line">  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MongockBuilderProviderImpl</span> <span class="token keyword">implements</span> <span class="token class-name">MongockBuilderProvider</span> <span class="token punctuation">{</span></div><div class="highlight-line">    <span class="token keyword">public</span> <span class="token class-name">RunnerStandaloneBuilder</span> <span class="token function">getBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></div><div class="highlight-line">      <span class="token comment">//...calling setter methods</span></div><div class="highlight-line">      <span class="token keyword">return</span> <span class="token class-name">MongockStandalone</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span></div><div class="highlight-line">    <span class="token punctuation">}</span></div><div class="highlight-line">  <span class="token punctuation">}</span></div><div class="highlight-line"><span class="token punctuation">}</span></div></code></pre>
<hr>
<h1 id="considerations"><a class="header-anchor" href="#considerations">#</a> Considerations</h1>
<h4 id="appjar-parameter"><a class="header-anchor" href="#appjar-parameter">#</a> appJar parameter</h4>
<p>The application uber jar is one of the mandatory parameters in all the operations(at least those operations interacting with the migration classes, <code>@ChangeUnit</code> and <code>@ChangeLog</code>). The Mongock CLI takes the migration classes, the dependencies and the runner builder from it.</p>
<h4 id="mongock-version-in-your-application"><a class="header-anchor" href="#mongock-version-in-your-application">#</a> Mongock version in your application</h4>
<p>Mongock CLI requires the application to be upgraded to Mongock version 5.</p>
<h4 id="professional-operations"><a class="header-anchor" href="#professional-operations">#</a> Professional operations</h4>
<p>There are some  operations labedl with <span class="professional">PRO</span>. This means it's a professional operation that requires the jar application to use the professional Mongock. Visit the <a href="/runner#professional">this section</a> to use Mongock professional in your application.</p>

      </article>
    </main>

    <!-- Footer -->
    <footer>
  <nav class="page-max-width d-flex flex-space-evenly flex-items-center">
    <a class="d-inline-flex flex-center flex-items-center" href="https://www.mongock.io">Mongock</a>
    <div class="d-flex flex-center flex-items-center">
      <a class="d-inline-flex flex-items-center mr-16" href="https://github.com/mongock/mongock" target="_blank" rel="nofollow">
        <!-- Source: <https://github.com/encharm/Font-Awesome-SVG-PNG/blob/master/black/svg/github.svg> -->
<svg focusable="false" viewBox="0 0 1792 1792"><title>GitHub</title><path d="M896 128q209 0 385.5 103t279.5 279.5 103 385.5q0 251-146.5 451.5t-378.5 277.5q-27 5-40-7t-13-30q0-3 .5-76.5t.5-134.5q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-119-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-85-13.5q-45 113-8 204-79 87-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-39 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 88.5t.5 54.5q0 18-13 30t-40 7q-232-77-378.5-277.5t-146.5-451.5q0-209 103-385.5t279.5-279.5 385.5-103zm-477 1103q3-7-7-12-10-3-13 2-3 7 7 12 9 6 13-2zm31 34q7-5-2-16-10-9-16-3-7 5 2 16 10 10 16 3zm30 45q9-7 0-19-8-13-17-6-9 5 0 18t17 7zm42 42q8-8-4-19-12-12-20-3-9 8 4 19 12 12 20 3zm57 25q3-11-13-16-15-4-19 7t13 15q15 6 19-6zm63 5q0-13-17-11-16 0-16 11 0 13 17 11 16 0 16-11zm58-10q-2-11-18-9-16 3-14 15t18 8 14-14z"></path></svg>

      </a>
      <a class="d-inline-flex flex-items-center" href="https://twitter.com/mongock" target="_blank" rel="nofollow">
        <!-- Source: <https://github.com/encharm/Font-Awesome-SVG-PNG/blob/master/black/svg/twitter.svg> -->
<svg focusable="false" viewBox="0 0 1792 1792"><title>Twitter</title><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path></svg>

      </a>
    </div>
    <a class="d-inline-flex flex-center flex-items-center" href="https://github.com/mongock/mongock/issues" target="_blank" rel="nofollow">
      <!-- Source: <https://octicons.github.com/icon/issue-opened/> -->
<svg viewBox="0 0 14 16" version="1.1" width="112" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>

      <span class="ml-8">Issues</span>
    </a>
  </nav>
</footer>


  </body>
</html>
